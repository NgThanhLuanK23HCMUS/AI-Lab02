\documentclass[12pt, a4paper]{article} 
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{tikz}
\usepackage{float}
\usetikzlibrary{positioning, arrows.meta}
\usepackage[left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm]{geometry}
\usepackage{caption} 
\usepackage{booktabs}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
}
\usetikzlibrary{trees,positioning,calc}
\usepackage{titlesec}
\usepackage{fancyvrb} % để dùng verbatim trong bảng
\usepackage{longtable}
\usepackage{array}
\usepackage{float}
\usepackage{geometry}
\usepackage{fancyvrb} % để dùng verbatim trong bảng
\usepackage{fvextra} % Quan trọng để Verbatim hoạt động trong bảng
\usepackage{changepage}
\usepackage{fontspec} % Dùng fontspec để hỗ trợ Unicode
\usepackage{polyglossia} % Thay thế babel trong trường hợp dùng Unicode
\setmainlanguage{vietnamese} % Đặt ngôn ngữ chính
\setmainfont{Arial} % Font Unicode phổ biến


\usetikzlibrary{shapes.geometric}
\usepackage{enumitem}
\usepackage{cancel}

\usepackage{float}      % (đặt ở phần đầu file để dùng [H])
\usepackage{array}


\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\nouppercase{\leftmark}}  % ← dùng leftmark thay vì rightmark
\fancyhead[R]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}

\renewcommand{\footrulewidth}{0pt} 
\renewcommand{\thesection}{\Roman{section}}
\renewcommand{\thesubsection}{\arabic{subsection}.}
\renewcommand{\thesubsubsection}{\arabic{subsection}.\arabic{subsubsection}}
\titleformat{\subsubsection}[runin] 
  {\normalfont\normalsize\bfseries}
  {\thesubsubsection}{1em}{}  
  [\vspace{0.5em}]             
\titlespacing*{\subsubsection}{2em}{1ex plus .2ex minus .2ex}{0.5ex}
\begin{document}

% --- Trang bìa tự thiết kế ---
\begin{titlepage}
    \centering
    \fontsize{16pt}{18pt}\selectfont
    \textbf{TRƯỜNG ĐẠI HỌC KHOA HỌC TỰ NHIÊN} \\
    \textbf{KHOA CÔNG NGHỆ THÔNG TIN} \\[1cm]

    \includegraphics[width=0.35\textwidth]{img/logohcmus.png} \\[1cm]

    {\fontsize{24pt}{26pt}\selectfont \textbf{Lab03: Học máy}} \\[1cm]

    \vspace{0.5cm}

    \begin{center}
        \renewcommand{\arraystretch}{1.2}
        \begin{tabular}{@{}ll}
            \textbf{Môn:} & Cơ sở trí tuệ nhân tạo \\[13pt]
            \textbf{Giáo viên hướng dẫn:} & Bùi Tiến Lên \\ 
                                          & Lê Nhựt Nam \\
                                          & Võ Nhật Tân\\[13pt]
            \textbf{Lớp:} & 23CLC03 \\[13pt]
            \textbf{Họ tên:} & Nguyễn Thành Luân \\[13pt]
            \textbf{Mã số sinh viên:} & 23127296 \\[13pt]
        \end{tabular}
    \end{center}

    \vfill

    {\Large \textbf{Hồ Chí Minh, 30/07/2025}}

\end{titlepage}


\tableofcontents  
\newpage         


\section{Giới thiệu}
\section{Các công trình liên quan}
\section{Kiến thức nền tảng}
\section{Phương pháp nghiên cứu}

\section{Thực nghiệm và Phân tích kết quả}
\subsection{Cài đặt thực nghiệm và bộ dữ liệu}

Trong phần này, tác giả tiến hành đánh giá mức độ chính xác và đáng tin cậy của các bộ ược lượng giá trị Shapley (Shapley Values - SV) áp dụng cho mô hình cây quyết định, đặc biệt tập trung vào các trường hợp khi các đặc trưng có tương quan hoặc xuất hiện các biến rời rạc/biến phân loại. Để làm rõ sự khác biệt, tác giả chia quá trình đánh giá thành hai thí nghiệm riêng biệt.


\subsubsection{Thí nghiêm 1: Đánh giá trên mô hình tuyến tính}
    \begin{itemize}[align=parleft, left=4em, labelsep=1em, itemsep=1em]
        \item \textbf{Bộ dữ liệu:} 
          \begin{itemize}[label=$\circ$, left=1em, labelsep=0.75em, itemsep=0.5em]
            \item Bao gồm $n = 10^4$ quan sát $\{(X_i, Y_i)\}_{i=1}^{n}$, trong đó mỗi $X_i$ là vector các đặc trưng của quan sát thứ $i$ và $Y_i$ là giá trị mục tiêu tương ứng.
            
            \item $X \in \mathbb{R}^p$ với $p = 5$ đặc trưng, theo phân phối Gaussian đa biến: 
            \begin{equation*}
                X \sim \mathcal{N}(0, \Sigma), \quad 
                \Sigma = \rho J_p + (\rho - 1) I_p, \quad 
                \rho = 0.7,
            \end{equation*}
            trong đó:
            
                \begin{itemize}[label=$+$, labelsep=0.3em, itemsep=0.2em]
                    \item $J_p$ là ma trận $p \times p$ mà tất cả các phần tử đều bằng 1, và $I_p$ là ma trận đơn vị $p \times p$.

                    \item $\Sigma$ là ma trận hiệp phương sai của các đặc trưng.
            %             - Đường chéo $(\Sigma)_{ii} = 0.4$ là phương sai của từng feature.\\
            % - Ngoại biên $(\Sigma)_{ij} = 0.7$ là hiệp phương sai (covariance) giữa các feature khác nhau, tạo tương quan dương giữa các đặc trưng.
                
                \end{itemize}
            

            
            
            
            \item Biến mục tiêu:
            \begin{equation*}
                Y = B^T X,
            \end{equation*}
            với:
            
             \begin{itemize}[label=$+$, labelsep=0.3em, itemsep=0.2em]
                \item Vector $B$ chứa trọng số của từng đặc trưng, xác định mức đóng góp của mỗi đặc trưng vào $Y_i$.
             \end{itemize}
           
            
        \end{itemize}

        \item \textbf{Chỉ số đánh giá và mô hình chuẩn so sánh}
          \begin{itemize}[label=$\circ$, left=1em, labelsep=0.75em, itemsep=0.5em]
                \item Chỉ số đánh giá
                    \begin{itemize}[label=$+$, labelsep=0.3em, itemsep=0.2em]
                        \item Relative Absolute Error (RAE): đo sai khác giữa SV ước lượng và SV thực
                        \item True Positive Rate (TPR): kiểm tra thứ hạng $k$ đặc trưng quan trọng nhất
                    \end{itemize}
                \item Mô hình chuẩn so sánh
                    \begin{itemize}[label=$+$, labelsep=0.3em, itemsep=0.2em]
                        \item TreeSHAP: thuật toán chuẩn cho mô hình cây
                        \item Leaf estimator: sử dụng kỳ vọng có điều kiện trong từng lá cây
                    \end{itemize}
            \end{itemize}

            \item \textbf{Phân tích kết quả và giải thích}
            
            Kết quả trong Hình 3 cho thấy sự khác biệt rõ rệt giữa các phương pháp ước lượng Shapley Value (SV) trên tập dữ liệu trên với $p=5$ đặc trưng. Cụ thể:
              \begin{itemize}[label=$\circ$, left=1em, labelsep=0.75em, itemsep=0.5em]
                \item \textbf{TreeSHAP} ($\hat{f}_{\text{SHAP}}$) có RAE trung bình = 3.31 và TPR = 86\% (±17\%), cho thấy mức độ sai số lớn hơn và khả năng giữ nguyên thứ hạng top-k feature thấp hơn.  

                \item \textbf{Leaf estimator} ($\hat{f}_{\text{Leaf}}$) có RAE = 0.90 và TPR = 94\% (±12\%), chứng tỏ độ chính xác cao hơn TreeSHAP, đặc biệt khi các đặc trưng có tương quan.  
              \end{itemize}
            
            

            
           \textbf{Giải thích:} 

             TreeShap: Do tác giả đang giả định là khi một feature phụ thuộc vào các feature khác - tức là feature đó nằm trong xích Markov của nó - TreeSHAP vẫn giả định rằng các feature ngoài tập feature đang xét là độc lập. Giả định này đồng nghĩa với việc mọi ảnh hưởng thực sự từ các feature trong xích Markov nhưng không xuất hiện trên path của cây đều bị bỏ qua khi tính giá trị đóng góp.
                        
            Ngược lại, Leaf estimator tính giá trị kỳ vọng có điều kiện của feature trong từng leaf, dựa trực tiếp trên phân phối thực tế của feature trong lá đó. Do đó, Leaf estimator phản ánh chính xác mức đóng góp của feature ngay cả khi có sự phụ thuộc giữa các feature hoặc dữ liệu không liên tục. Kết quả là Leaf estimator ít bị bias hơn và cho các giá trị Shapley gần với true SV hơn, giúp giải thích mô hình đáng tin cậy hơn.


        
    \end{itemize}




\section{Kết luận và định hướng nghiên cứu tương lai}

\subsection{Kết luận}

Chúng tôi đã chỉ ra rằng việc triển khai hiện tại của Shapley Values (SV) có thể dẫn đến các giải thích thiếu tin cậy do ước lượng bị sai lệch hoặc xử lý không phù hợp với biến phân loại. Để khắc phục vấn đề này, chúng tôi đã đề xuất các bộ ước lượng mới và đưa ra phương pháp đúng để xử lý biến phân loại. 

Kết quả thực nghiệm cho thấy ngay cả trong những mô hình đơn giản, sự khác biệt giữa phương pháp tiên tiến hiện nay (TreeSHAP) và các phương pháp được đề xuất là đáng kể.

Mặc dù có sự quan tâm ngày càng lớn đến lĩnh vực AI đáng tin cậy, tác động của những sai lệch này trong giải thích vẫn chưa được hiểu rõ. Nguyên nhân là do khó khăn trong việc đánh giá định lượng chất lượng của một lời giải thích, vốn phụ thuộc vào phân phối dữ liệu gốc, thứ rất khó để ước lượng. Hơn nữa, quá trình đánh giá thường dễ bị ảnh hưởng bởi thiên kiến xác nhận (confirmation bias).

Chúng tôi cũng cho rằng chất lượng ước lượng không phải là hạn chế duy nhất của SV. Thực tế, chúng tôi chứng minh trong Mệnh đề 5.1 rằng giải thích bằng SV không phải là giải thích cục bộ (local), mà vẫn mang tính toàn cục (global), ngay cả trong mô hình tuyến tính đơn giản.

Mệnh đề 5.1 cho thấy rằng SV không thực sự đo lường mang tính cục bộ, mà thay vào đó vẫn chịu ảnh hưởng toàn cục. Nguyên nhân là khi tính SV cho $X_1$ hoặc $X_2$, ta cũng xem xét các tập con $S$ không chứa $X_5$. Quá trình lấy trung bình và thay đổi dấu của $X_5$ đã vô tình đưa cả mô hình tuyến tính còn lại (không áp dụng cho quan sát hiện tại) vào. 

Phát hiện này đặt ra những thách thức lớn trong việc diễn giải SV và cho thấy các hạn chế thường bị bỏ qua trong thực tiễn do thiếu sự chính xác và hiểu biết về Shapley Values.

\subsection{Định hướng nghiên cứu tương lai}

Trong tương lai, có thể tập trung vào các hướng sau:
\begin{itemize}
    \item Phát triển bộ chuẩn đánh giá hệ thống cho chất lượng giải thích trong AI. 
    \item Nghiên cứu các phương pháp thay thế SV mang lại giải thích thực sự cục bộ. 
    \item Mở rộng phân tích sang mô hình phi tuyến và không gian chiều cao. 
    \item Khảo sát tác động tâm lý và thực tiễn của các sai lệch trong giải thích AI khi áp dụng trong các hệ thống thực tế. 
\end{itemize}

\end{document}
